<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‹¼äººæ®º Online</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #222; color: #fff; }
        .container { max_width: 600px; margin: 0 auto; }
        .card { background: #333; padding: 20px; margin-bottom: 20px; border-radius: 8px; }
        input, button { padding: 10px; margin: 5px; width: 100%; box-sizing: border-box; }
        button { cursor: pointer; background: #555; color: white; border: none; font-weight: bold;}
        button:hover { background: #777; }
        .hidden { display: none; }
        .dead { text-decoration: line-through; color: #888; }
        #log-area { height: 200px; overflow-y: scroll; background: #000; padding: 10px; border: 1px solid #444; margin-bottom: 10px;}
        .setup-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .setup-row input { width: 50px; text-align: center; color: black;}
        .number-badge { background: #ff9800; color: black; border-radius: 50%; padding: 2px 8px; margin-right: 5px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸº ç‹¼äººæ®º Online</h1>

    <div id="login-view" class="card">
        <h3>åŠ å…¥æˆ¿é–“</h3>
        <input type="text" id="username" placeholder="ä½ çš„æš±ç¨±">
        <input type="text" id="room" placeholder="æˆ¿é–“è™Ÿç¢¼ (101)" value="101">
        <button onclick="joinGame()" style="background: #1976d2;">åŠ å…¥å¤§å»³</button>
    </div>

    <div id="lobby-view" class="card hidden">
        <h3>ç­‰å¾…ç©å®¶åŠ å…¥...</h3>
        <ul id="player-list"></ul>
        <hr>
        
        <div id="host-settings" class="hidden">
            <h3>ğŸ‘‘ æˆ¿ä¸»è¨­å®š</h3>
            <div class="setting-item">ğŸº ç‹¼äººï¼š<input type="number" id="role-wolf" value="1" min="0"></div>
            <div class="setting-item">ğŸ‘‘ ç‹¼ç‹ï¼š<input type="number" id="role-wolfking" value="0" min="0"></div>
            <div class="setting-item">ğŸ”® é è¨€å®¶ï¼š<input type="number" id="role-seer" value="1" min="0"></div>
            <div class="setting-item">ğŸ§ª å¥³å·«ï¼š<input type="number" id="role-witch" value="1" min="0"></div>
            <div class="setting-item">ğŸ›¡ï¸ å®ˆè¡›ï¼š<input type="number" id="role-guard" value="0" min="0"></div>
            <div class="setting-item">ğŸ”« çµäººï¼š<input type="number" id="role-hunter" value="0" min="0"></div>
            <div class="setting-item">æ‘æ°‘ï¼š<input type="number" id="role-villager" value="3" min="0"></div>
            <div style="margin-top: 15px; display: flex; gap: 10px;">
                <button onclick="startGame()" style="flex: 2; background: #4caf50;">é–‹å§‹éŠæˆ²</button>
                <button onclick="resetGame()" style="flex: 1; background: #f44336;">ğŸ”„ é‡ç½®</button>
            </div>
        </div>

        <div id="guest-waiting-msg" class="hidden">
            <h4 style="color: #ccc;">ç­‰å¾…æˆ¿ä¸»è¨­å®šéŠæˆ²...</h4>
        </div>
    </div>

    <div id="game-view" class="card hidden">
        <h2 id="phase-title" style="color: #ff9800;">è¼‰å…¥ä¸­...</h2>
        <div id="my-role-info" style="font-size: 1.2em; font-weight: bold; margin-bottom: 10px; color: cyan;"></div>
        
        <div id="witch-area" class="card hidden" style="border: 1px solid #e040fb;">
            <h4 style="color: #e040fb; margin:0 0 10px 0;">ğŸ”® å¥³å·«è¦–è§’</h4>
            <p>ç‹¼äººé›†ç«ï¼š<span id="victim-name" style="color: red;">æœªçŸ¥</span></p>
            <button id="btn-save" onclick="usePotion('save')" style="background: #e040fb;" disabled>ä½¿ç”¨è§£è—¥</button>
        </div>

        <div id="guard-area" class="card hidden" style="border: 1px solid #4caf50;">
            <h4 style="color: #4caf50; margin:0 0 10px 0;">ğŸ›¡ï¸ å®ˆè¡›è¦–è§’</h4>
            <p>ç›®å‰å®ˆè­·ï¼š<span id="guard-target" style="color: lightgreen; font-weight: bold;">å°šæœªé¸æ“‡</span></p>
            <p style="font-size: 0.8em; color: #aaa;">(é»æ“Šé ­åƒåˆ‡æ›å°è±¡ï¼Œç¢ºå®šå¾ŒæŒ‰çµæŸå›åˆ)</p>
        </div>

        <div id="log-area"></div>
        <h3>ç©å®¶åˆ—è¡¨</h3>
        <div id="game-players"></div>

        <div style="margin-top: 20px; padding-top: 10px; border-top: 1px solid #555;">
            <button id="btn-end-turn" onclick="confirmTurn()" class="hidden" style="background: #ff9800; color: black;">çµæŸæˆ‘çš„å›åˆ</button>
            <button id="btn-start-vote" onclick="startVoting()" class="hidden" style="background: #2196f3;">ç™¼è¨€çµæŸ -> é–‹å§‹æŠ•ç¥¨</button>
            
            <button id="btn-abstain" onclick="voteAbstain()" class="hidden" style="background: #9e9e9e; color: black;">âšª æ£„ç¥¨ (è·³é)</button>
            
            <button id="btn-go-night" onclick="goToNight()" class="hidden" style="background: #000; border: 1px solid #666;">è™•æ±ºå®Œæˆ -> å…¥å¤œ</button>
        </div>
    </div>
</div>

<div id="custom-modal" class="modal-overlay hidden">
    <div class="modal-content">
        <h3 id="modal-title" style="color: #ff9800; margin-top: 0;">æç¤º</h3>
        <p id="modal-message" style="font-size: 1.1em; margin: 20px 0;">è¨Šæ¯å…§å®¹</p>
        <div class="modal-buttons">
            <button id="btn-modal-cancel" onclick="closeModal()" style="background: #666;">å–æ¶ˆ</button>
            <button id="btn-modal-confirm" style="background: #2196f3;">ç¢ºå®š</button>
        </div>
    </div>
</div>

<div id="toast-message" class="toast hidden"></div>
<script src="/static/script.js"></script>
</body>
</html>